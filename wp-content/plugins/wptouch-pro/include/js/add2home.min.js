/*!
 * Add to Homescreen v1.0.8 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
(function(){var j=navigator,k=(/iphone|ipod|ipad/gi).test(j.platform),w=(/ipad/gi).test(j.platform),o="devicePixelRatio" in window&&window.devicePixelRatio>1,x=j.appVersion.match(/Safari/gi),a="standalone" in j&&k,z=a&&j.standalone,f=j.appVersion.match(/OS \d+_\d+/g),y=j.platform.split(" ")[0],q=j.language.replace("-","_"),v=startX=0,g=localStorage.getItem("_addToHome"),t,m,b,u,r,e={animationIn:"drop",animationOut:"fade",startDelay:2000,lifespan:20000,bottomOffset:14,expire:0,message:"",touchIcon:false,arrow:true,iterations:100},p={en_us:"Install this web app on your [device]: tap [icon] and then <strong>Add to Home Screen</strong>.",};f=f?f[0].replace(/[^\d_]/g,"").replace("_",".")*1:0;g=g=="null"?0:g*1;if(window.addToHomeConfig){for(u in window.addToHomeConfig){e[u]=window.addToHomeConfig[u]}}if(!e.expire||g<new Date().getTime()){g=0}if(a&&!g&&!z&&x){document.addEventListener("DOMContentLoaded",n,false);window.addEventListener("load",s,false)}function n(){document.removeEventListener("DOMContentLoaded",n,false);var C=document.createElement("div"),B,A=e.touchIcon?document.querySelectorAll("head link[rel=apple-touch-icon],head link[rel=apple-touch-icon-precomposed]"):[],l,i="";C.id="addToHomeScreen";C.style.cssText+="position:absolute;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);";C.style.left="-9999px";if(e.message in p){q=e.message;e.message=""}if(e.message==""){e.message=q in p?p[q]:p.en_us}if(A.length){for(u=0,r=A.length;u<r;u++){l=A[u].getAttribute("sizes");if(l){if(o&&l=="114x114"){i=A[u].href;break}}else{i=A[u].href}}i='<span style="background-image:url('+i+')" class="touchIcon"></span>'}C.className=(w?"ipad":"iphone")+(i?" wide":"");C.innerHTML=i+e.message.replace("[device]","%device").replace("[icon]","%icon").replace("%device",y).replace("%icon",f>=4.2?'<span class="share"></span>':'<span class="plus">+</span>')+(e.arrow?'<span class="arrow"></span>':"")+'<span class="close">\u00D7</span>';document.body.appendChild(C);b=C;B=b.querySelector(".close");if(B){B.addEventListener("click",c,false)}if(e.expire){localStorage.setItem("_addToHome",new Date().getTime()+e.expire*60*1000)}}function s(){window.removeEventListener("load",s,false);setTimeout(function(){var i;v=w?window.scrollY:window.innerHeight+window.scrollY;startX=w?window.scrollX:Math.round((window.innerWidth-b.offsetWidth)/2)+window.scrollX;b.style.top=w?v+e.bottomOffset+"px":v-b.offsetHeight-e.bottomOffset+"px";b.style.left=w?startX+(f>=5?160:208)-Math.round(b.offsetWidth/2)+"px":startX+"px";switch(e.animationIn){case"drop":if(w){i="0.6s";b.style.webkitTransform="translate3d(0,"+-(window.scrollY+e.bottomOffset+b.offsetHeight)+"px,0)"}else{i="0.9s";b.style.webkitTransform="translate3d(0,"+-(v+e.bottomOffset)+"px,0)"}break;case"bubble":if(w){i="0.6s";b.style.opacity="0";b.style.webkitTransform="translate3d(0,"+(v+50)+"px,0)"}else{i="0.6s";b.style.webkitTransform="translate3d(0,"+(b.offsetHeight+e.bottomOffset+50)+"px,0)"}break;default:i="1s";b.style.opacity="0"}setTimeout(function(){b.style.webkitTransitionDuration=i;b.style.opacity="1";b.style.webkitTransform="translate3d(0,0,0)";b.addEventListener("webkitTransitionEnd",h,false)},0);m=setTimeout(c,e.lifespan)},e.startDelay)}function h(){b.removeEventListener("webkitTransitionEnd",h,false);b.style.webkitTransitionProperty="-webkit-transform";b.style.webkitTransitionDuration="0.2s";if(m){clearInterval(t);t=setInterval(d,e.iterations)}else{b.parentNode.removeChild(b)}}function d(){var i=new WebKitCSSMatrix(window.getComputedStyle(b,null).webkitTransform),l=w?window.scrollY-v:window.scrollY+window.innerHeight-v,A=w?window.scrollX-startX:window.scrollX+Math.round((window.innerWidth-b.offsetWidth)/2)-startX;if(l==i.m42&&A==i.m41){return}clearInterval(t);b.removeEventListener("webkitTransitionEnd",h,false);setTimeout(function(){b.addEventListener("webkitTransitionEnd",h,false);b.style.webkitTransform="translate3d("+A+"px,"+l+"px,0)"},0)}function c(){clearInterval(t);clearTimeout(m);m=null;b.removeEventListener("webkitTransitionEnd",h,false);var B=w?window.scrollY-v:window.scrollY+window.innerHeight-v,C=w?window.scrollX-startX:window.scrollX+Math.round((window.innerWidth-b.offsetWidth)/2)-startX,i="1",l="0",A=b.querySelector(".close");if(A){A.removeEventListener("click",c,false)}b.style.webkitTransitionProperty="-webkit-transform,opacity";switch(e.animationOut){case"drop":if(w){l="0.4s";i="0";B=B+50}else{l="0.6s";B=B+b.offsetHeight+e.bottomOffset+50}break;case"bubble":if(w){l="0.8s";B=B-b.offsetHeight-e.bottomOffset-50}else{l="0.4s";i="0";B=B-50}break;default:l="0.8s";i="0"}b.addEventListener("webkitTransitionEnd",h,false);b.style.opacity=i;b.style.webkitTransitionDuration=l;b.style.webkitTransform="translate3d("+C+"px,"+B+"px,0)"}window.addToHomeClose=c})();